---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const items = await getCollection("portfolio");
  return items.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { data } = entry;
const { Content } = await entry.render();
---

<BaseLayout
  title={data.title}
  description={`${data.category}${data.location ? ` • ${data.location}` : ""}`}
>
  <article class="panel" style="padding: 18px;">
    <p class="kicker">{data.category}</p>
    <h1 style="margin-top: 6px;">{data.title}</h1>

    {
      (data.location || data.date) && (
        <p class="small" style="margin-top: 8px;">
          {data.location ? data.location : ""}
          {data.location && data.date ? " • " : ""}
          {data.date ? data.date : ""}
        </p>
      )
    }

    <div class="hr"></div>

    <img
      src={data.coverUrl}
      alt={data.coverAlt}
      loading="eager"
      decoding="async"
      style="border-radius: var(--radius); border: 1px solid var(--border);"
    />

    <div style="max-width: 72ch; margin-top: 14px;">
      <Content />
    </div>

    <div style="margin-top: 16px; display:flex; gap:10px; flex-wrap:wrap;">
      <a class="btn" href="/portfolio">← Back to portfolio</a>
      <a class="btn accent" href="/prints">Buy a print</a>
    </div>
  </article>
</BaseLayout>
